import pandas as pd
from math import sqrt;
from sklearn import preprocessing
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score#, r2_score, confusion_matrix, mean_absolute_error, mean_squared_error, f1_score, log_loss
# from sklearn.model_selection import train_test_split
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import joblib

def concatdataset(malicious, benign):
    if malicious == "" and benign == "":
        print("Provide at least 1 valid filename")
        exit(0)


    if malicious != "":
        mal = pd.read_csv(malicious)

    if benign != "":
        ben = pd.read_csv(benign)

    if malicious == "":
        validate_data = ben 
    elif ben == "":
        validate_data = mal 
    else:
        validate_data = pd.concat([ben, mal], ignore_index=True)
    
    validate_data = validate_data.sample(frac = 1).reset_index(drop = True)

    validate_y = validate_data["isMalware"]
    validate_x = validate_data.drop(["isMalware"], axis= 1)
    return validate_x, validate_y




model = joblib.load("RandomForestClassifier.joblib")


malicious = "sus.csv"
benign = "benign.csv"


x_test , y_test = concatdataset(malicious, benign)

y_pred = model.predict(x_test)

print('Random Forest Classifier Accuracy score: ', accuracy_score(y_test, y_pred))

exit(0)